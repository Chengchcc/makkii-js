# `@makkii/app-aion`

> TODO: description

## install

```bash
npm install @makkii/app-aion
```

## Usage

```js
import {AionApiClient, AionKeystoreClient} from '@makkii/app-aion'
const isTestNet = false;
const apiClient = new AionApiClient(isTestNet);
const keystoreClient = new AionKeystoreClient();
// API
const getBalance = aysnc (address) => {
    const balance = await apiClient.getBalance(address);
    return balance;
}
// 
```

if you want to learn more, please see [api-client guide](../../docs/api-client.md) and [keysote-client guide](../../docs/keysotre-client.md).

## API

<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

#### Table of Contents

-   [IAionConfig](#iaionconfig)
    -   [explorer_api](#explorer_api)
    -   [explorer](#explorer)
    -   [remote_api](#remote_api)
-   [AionKeystoreClient](#aionkeystoreclient)
    -   [getAccountFromMnemonic](#getaccountfrommnemonic)
        -   [Parameters](#parameters)
    -   [recoverKeyPairByPrivateKey](#recoverkeypairbyprivatekey)
        -   [Parameters](#parameters-1)
    -   [recoverKeyPairByKeyFile](#recoverkeypairbykeyfile)
        -   [Parameters](#parameters-2)
    -   [validatePrivateKey](#validateprivatekey)
        -   [Parameters](#parameters-3)
    -   [validateAddress](#validateaddress)
        -   [Parameters](#parameters-4)
-   [AionApiClient](#aionapiclient)
    -   [Parameters](#parameters-5)
    -   [getNetwork](#getnetwork)
    -   [getBlockByNumber](#getblockbynumber)
        -   [Parameters](#parameters-6)
    -   [getBlockNumber](#getblocknumber)
    -   [getTransactionStatus](#gettransactionstatus)
        -   [Parameters](#parameters-7)
    -   [getTransactionsByAddress](#gettransactionsbyaddress)
        -   [Parameters](#parameters-8)
    -   [sendTransaction](#sendtransaction)
        -   [Parameters](#parameters-9)
    -   [getTokenIconUrl](#gettokeniconurl)
        -   [Parameters](#parameters-10)
    -   [buildTransaction](#buildtransaction)
        -   [Parameters](#parameters-11)

### IAionConfig

Aion configuration interface

#### explorer_api

api endpoint that used to query transaction information

Type: [string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)

#### explorer

transaction page base url

Type: [string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)

#### remote_api

app server endpoint that provides token, icons, etc.

Type: [string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)

### AionKeystoreClient

Aion keystore client that implements IsingleKeystoreClient interface

#### getAccountFromMnemonic

Get account from mnemonic

##### Parameters

-   `address_index` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** index in hd wallet
-   `mnemonic` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** mnemonic phrase

Returns **any** account object: { private_key: '', public_key: '', address: '', index: '' }

#### recoverKeyPairByPrivateKey

Recover key pair by private key

##### Parameters

-   `priKey` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** 
-   `privKey`  private key

Returns **any** key pair object: { private_key: '', public_key: '', address: '' }

#### recoverKeyPairByKeyFile

Recover key pair by key file

##### Parameters

-   `file` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** file content
-   `password` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** protection password

Returns **any** key pair object: { private_key: '', public_key: '', address: '' }

#### validatePrivateKey

Check if private key is valid

##### Parameters

-   `privateKey` **([string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String) \| [Buffer](https://nodejs.org/api/buffer.html))** string or Buffer

Returns **any** if private key is valid

#### validateAddress

Check if address is valid

##### Parameters

-   `address` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** address to be validated

### AionApiClient

Aion api client that implement IsingleApiFullClient

#### Parameters

-   `config` **[IAionConfig](#iaionconfig)** 

#### getNetwork

Get network name: mainnet, amity and mastery.

#### getBlockByNumber

Get block by number, block information doesn't contains transaction details

##### Parameters

-   `blockNumber` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** block number's hex string

Returns **any** eth_getBlockNumber response's result

#### getBlockNumber

Get latest block number

Returns **any** eth_getBlockNumber response's result

#### getTransactionStatus

Get transaction status.

##### Parameters

-   `hash` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** transaction hash

Returns **any** if eth_getTransactionReceipt is null, returns null;
         else return object { status: true/false, blockNumber: intger, gasUsed: integer }

#### getTransactionsByAddress

Get transactions by the given address

##### Parameters

-   `address` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** account address
-   `page` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** page number
-   `size` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** page size

Returns **any** array of object structure which contains:
         hash: string, with prefix 0x
         timestamp: milli-seconds from 1970
         from: sender
         to: receiver
         value: transfer amount
         status: 'CONFIRMED' or 'FAILED'
         blockNumber: hex string
         fee: integer

#### sendTransaction

Send transaction

##### Parameters

-   `unsignedTx` **AionUnsignedTx** unsigned transaction build by buildTransaction
-   `signer` **IkeystoreSigner** localSigner or hardware
-   `signerParams` **any**     localSigner: {private_key} hardware:{derivationIndex}

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;AionPendingTx>** 

#### getTokenIconUrl

throw not implementated error

##### Parameters

-   `tokenSymbol` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** 
-   `contractAddress` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** 

#### buildTransaction

TODO: not general enough.
Build transaction

options parameters contains: gasLimit, gasPrice, isTokenTransfer, data(optional), contractAddr(optional), tokenDecimal(optional).
if isTokenTransfer is true, transaction value is zero and transaction to is token contract creation address,
to parameter is encoded in data.

##### Parameters

-   `from` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** transaction sender
-   `to` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** amount receiver
-   `value` **BigNumber** amount value
-   `options` **{gasLimit: [number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number), gasPrice: [number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number), isTokenTransfer: [boolean](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean), data: any?, contractAddr: [string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)?, tokenDecimal: [number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)?}** extra parameters

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;AionUnsignedTx>** 
