# `@makkii/app-tron`

Tron application client.

This library uses some third-party service:

-   Tron Grid API - you can pass in api endpoint in [TronApiClient](#tronapiclient) Constructor
-   Explorer Api - To get transaction history, token history, we use `https://apilist.tronscan.org/api`
-   Transaction Explorer - To show transaction detail page, we use `https://tronscan.org/#/transaction`

## Installation

```bash
$ npm install @makkii/app-tron
```

## Usage

```javascript
import { TronApiClient, TronKeystoreClient, TronLocalSigner } from '@makkii/app-eth';

const api_client = new TronApiClient({
    network: 'mainnet',
    trongrid_api: 'https://api.trongrid.io'
});
api_client.getBalance('TCwypatGAoUhhQCnhuk3hEx8XPJYZ8Wfup')
    .then(console.log)
    .catch(error=>console.log(error));
const keystore_client = new TronKeystoreClient();
api_client.buildTransaction(
    'TCwypatGAoUhhQCnhuk3hEx8XPJYZ8Wfup', // from address
    'TJuJxDPeqbGT8epGAUcZSuMSxy5SC7aYfT', // to address
    0, // amount
).then(function(unsignedTx) {
    keystore_client.signTransaction(unsignedTx, new TronLocalSigner(), {
        private_key: '***'
    }).then(function(signedTx) {
        console.log(signedTx);
    });
});
```

## API

<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

#### Table of Contents

-   [TronKeystoreClient](#tronkeystoreclient)
    -   [signTransaction](#signtransaction)
        -   [Parameters](#parameters)
    -   [generateMnemonic](#generatemnemonic)
    -   [recoverKeyPairByPrivateKey](#recoverkeypairbyprivatekey)
        -   [Parameters](#parameters-1)
    -   [validatePrivateKey](#validateprivatekey)
        -   [Parameters](#parameters-2)
    -   [validateAddress](#validateaddress)
        -   [Parameters](#parameters-3)
    -   [getAccountFromMnemonic](#getaccountfrommnemonic)
        -   [Parameters](#parameters-4)
    -   [getAccountFromHardware](#getaccountfromhardware)
        -   [Parameters](#parameters-5)
-   [TronUnsignedTx](#tronunsignedtx)
-   [TronLocalSigner](#tronlocalsigner)
    -   [signTransaction](#signtransaction-1)
        -   [Parameters](#parameters-6)
-   [ITronConfig](#itronconfig)
    -   [network](#network)
    -   [trongrid_api](#trongrid_api)
    -   [explorer_api](#explorer_api)
    -   [explorer](#explorer)
-   [TronPendingTx](#tronpendingtx)
-   [TronApiClient](#tronapiclient)
    -   [Parameters](#parameters-7)
    -   [getNetwork](#getnetwork)
    -   [updateConfiguration](#updateconfiguration)
        -   [Parameters](#parameters-8)
    -   [getBlockByNumber](#getblockbynumber)
        -   [Parameters](#parameters-9)
    -   [getBlockNumber](#getblocknumber)
    -   [getTransactionStatus](#gettransactionstatus)
        -   [Parameters](#parameters-10)
    -   [getTransactionExplorerUrl](#gettransactionexplorerurl)
        -   [Parameters](#parameters-11)
    -   [getBalance](#getbalance)
        -   [Parameters](#parameters-12)
    -   [sendTransaction](#sendtransaction)
        -   [Parameters](#parameters-13)
    -   [sameAddress](#sameaddress)
        -   [Parameters](#parameters-14)
    -   [buildTransaction](#buildtransaction)
        -   [Parameters](#parameters-15)
-   [TronTxStatus](#trontxstatus)
-   [TronTransaction](#trontransaction)
-   [TronKeypair](#tronkeypair)

### TronKeystoreClient

#### signTransaction

Sign transaction by signer

##### Parameters

-   `tx` **[TronUnsignedTx](#tronunsignedtx)** 
-   `signer` **IkeystoreSigner** localSigner or hardware
-   `signerParam` **any** localSigner: {private_key} hardware:{derivationIndex}
-   `unsignedTx`  unsigned transaction build by buildTransaction

Returns **any** encoded transaction

#### generateMnemonic

Generate mnemonic by bip39

Returns **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** 12 length of mnemonic

#### recoverKeyPairByPrivateKey

Recover key pair by private key

##### Parameters

-   `priKey` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** 

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;[TronKeypair](#tronkeypair)>** 

#### validatePrivateKey

Validate private key

not implemented

##### Parameters

-   `privateKey` **([string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String) \| [Buffer](https://nodejs.org/api/buffer.html))** 

#### validateAddress

Validate address

##### Parameters

-   `address` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** 

Returns **[boolean](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean)** 

#### getAccountFromMnemonic

Get account from mnemonic

##### Parameters

-   `address_index` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** bip39 path index
-   `mnemonic` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** 

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;[TronKeypair](#tronkeypair)>** 

#### getAccountFromHardware

Get account from hardware

not implemented

##### Parameters

-   `_address_index` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** 
-   `hardware` **IHardware** 

### TronUnsignedTx

Tron unsigned transaction

-   to: string;
-   owner: string;
-   amount: BigNumber;
-   timestamp: number;
-   expiration: number;
-   latest_block: { hash: string; number: string; };

### TronLocalSigner

#### signTransaction

Sign transaction of tron local signer

##### Parameters

-   `transaction` **[TronUnsignedTx](#tronunsignedtx)** 
-   `params` **{}** {private_key: string}

Returns **any** signed tron tx

### ITronConfig

#### network

Network name.

Type: (`"mainnet"` \| `"shasta"`)

#### trongrid_api

trongrid api

Type: [string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)

#### explorer_api

explorer_api use to get transactions by address

Type: [string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)

#### explorer

explorer url that show transaction detail

Type: [string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)

### TronPendingTx

Tron pending transaction

-   to: string;
-   from: string;
-   value: BigNumber;
-   timestamp: number;
-   hash: string;
-   status: "PENDING";

### TronApiClient

Tron api client that implement IsingleApiClient

#### Parameters

-   `config` **[ITronConfig](#itronconfig)** 

#### getNetwork

Get network

Returns **any** nework    mainnet|shasta

#### updateConfiguration

Update tron api config

##### Parameters

-   `config` **[ITronConfig](#itronconfig)** 

#### getBlockByNumber

Get block by number

not implemented

##### Parameters

-   `blockNumber` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** 

#### getBlockNumber

Get block height

not implemented

#### getTransactionStatus

Get transaction status by tx hash

##### Parameters

-   `hash` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** tx hash

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;[TronTxStatus](#trontxstatus)>** 

#### getTransactionExplorerUrl

Get an explorer url showing transaction details

##### Parameters

-   `hash` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** 

Returns **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** url

#### getBalance

Get an account's balance

##### Parameters

-   `address` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** 

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;BigNumber>** balance

#### sendTransaction

Send transaction

##### Parameters

-   `unsignedTx` **[TronUnsignedTx](#tronunsignedtx)** unsigned transaction build by buildTransaction
-   `signer` **IkeystoreSigner** localSigner or hardware
-   `signerParams` **any**     localSigner: {private_key} hardware:{derivationIndex}

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;[TronPendingTx](#tronpendingtx)>** 

#### sameAddress

check if two address is same

##### Parameters

-   `address1` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** 
-   `address2` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** 

Returns **[boolean](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean)** 

#### buildTransaction

Build transaction

##### Parameters

-   `from` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** 
-   `to` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** 
-   `value` **BigNumber** 

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;[TronUnsignedTx](#tronunsignedtx)>** 

### TronTxStatus

Tron transaction status

-   blockNumber: number;
-   status: boolean;

### TronTransaction

Tron transaction

-   hash: string;
-   timestamp: number;
-   from: string;
-   to: string;
-   value: BigNumber;
-   blockNumber: number;
-   status: "CONFIRMED" | "FAILED";

### TronKeypair

Tron key pair

-   private_key: string;
-   public_key: string;
-   address: string;
-   index?: number;
-   sign?: (hash: any) => Buffer;
